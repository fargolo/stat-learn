0,0,1,0,1,0,
0,0,0,1,1,0,
0,0,0,0,1,1,
0,0,0,0,0,1),ncol=6,nrow = 6)
mark_regn <- network(mark_reg)
set.vertex.attribute(mark_regn, attrname = "vertex.names",
value = c("Y","+","W21","W22","W1","X"))
mark_regn_plot <- ggnetwork(mark_regn)
ggplot(mark_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="darkorchid1",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "open",ends = "last"),
color = "white",
curvature = 0,size=1) +
geom_nodetext(aes(label = vertex.names),color="white",
fontface = "bold",size=3,nudge_y = -0.2) +
xlim(-0.1,1.1)+ylim(-0.3,1.2)+
theme_hc(style="darkunica")+ylab("")+xlab("")+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank())
set.seed(2600)
mark_reg <- matrix(c(1,1,0,0,0,0,
0,1,1,1,0,0,
0,0,1,0,1,0,
0,0,0,1,1,0,
0,0,0,0,1,1,
0,0,0,0,0,1),ncol=6,nrow = 6)
mark_regn <- network(mark_reg)
set.vertex.attribute(mark_regn, attrname = "vertex.names",
value = c("Y","+","W21","W22","W1","X"))
mark_regn_plot <- ggnetwork(mark_regn)
ggplot(mark_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="darkorchid1",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "open",ends = "last"),
color = "white",
curvature = 0,size=1) +
geom_nodetext(aes(label = vertex.names),color="white",
fontface = "bold",size=3,nudge_y = -0.2) +
xlim(-0.1,1.1)+ylim(-0.3,1.2)+
theme_hc(style="darkunica")+ylab("")+xlab("")+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank())
ggsave("images/chap4-nn.png",type="cairo-png",units="cm",width = 15,height = 8,dpi=300)
ggplot(mark_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="magenta",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "open",ends = "last"),
color = "white",
curvature = 0,size=1) +
geom_nodetext(aes(label = vertex.names),color="white",
fontface = "bold",size=3,nudge_y = -0.2) +
xlim(-0.1,1.1)+ylim(-0.3,1.2)+
theme_hc(style="darkunica")+ylab("")+xlab("")+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank())
ggsave("images/chap4-nn.png",type="cairo-png",units="cm",width = 15,height = 8,dpi=300)
?scale_color_discrete()
?scale_color_manual
ggplot(iris,aes(x=Sepal.Length,y=Sepal.Width,color=Species))+
geom_point()+ geom_abline(slope = 0.92,intercept = -1.9,color="mediumorchid1")+
scale_colour_manual(values = c("red", "blue", "green"))+
theme_hc(style = "darkunica")
ggplot(iris,aes(x=Sepal.Length,y=Sepal.Width,color=Species))+
geom_point()+ geom_abline(slope = 0.92,intercept = -1.9,color="mediumorchid1")+
scale_colour_manual(values = c("red", "blue", "deepskyblue"))+
theme_hc(style = "darkunica")
ggplot(iris,aes(x=Sepal.Length,y=Sepal.Width,color=Species))+
geom_point()+ geom_abline(slope = 0.92,intercept = -1.9,color="mediumorchid1")+
scale_colour_manual(values = c("red", "gold", "deepskyblue"))+
theme_hc(style = "darkunica")
ggplot(iris,aes(x=Sepal.Length,y=Sepal.Width,color=Species))+
geom_point()+ geom_abline(slope = 0.92,intercept = -1.9,color="mediumorchid1")+
scale_colour_manual(values = c("red", "blue4", "deepskyblue"))+
theme_hc(style = "darkunica")
ggplot(iris,aes(x=Sepal.Length,y=Sepal.Width,color=Species))+
geom_point()+ geom_abline(slope = 0.92,intercept = -1.9,color="mediumorchid1")+
scale_colour_manual(values = c("orangered", "gold", "deepskyblue"))+
theme_hc(style = "darkunica")
ggplot(iris,aes(x=Sepal.Length,y=Sepal.Width,color=Species))+
geom_point()+ geom_abline(slope = 0.92,intercept = -1.9,color="mediumorchid1")+
scale_colour_manual(values = c("gold", "orangered", "deepskyblue"))+
theme_hc(style = "darkunica")
ggplot(iris,aes(x=Sepal.Length,y=Sepal.Width,color=Species))+
geom_point()+ geom_abline(slope = 0.92,intercept = -1.9,color="deepskyblue")+
scale_colour_manual(values = c("gold", "orangered", "mediumorchid1"))+
theme_hc(style = "darkunica")
ggplot(iris,aes(x=Sepal.Length,y=Sepal.Width,color=Species))+
geom_point()+ geom_abline(slope = 0.92,intercept = -1.9,color="deepskyblue")+
scale_colour_manual(values = c("gold", "orangered", "deeppink"))+
theme_hc(style = "darkunica")
ggplot(iris,aes(x=Sepal.Length,y=Sepal.Width,color=Species))+
geom_point()+ geom_abline(slope = 0.92,intercept = -1.9,color="deepskyblue")+
scale_colour_manual(values = c("gold", "orangered", "darkviolet"))+
theme_hc(style = "darkunica")
ggplot(iris,aes(x=Sepal.Length,y=Sepal.Width,color=Species))+
geom_point()+ geom_abline(slope = 0.92,intercept = -1.9,color="mediumorchid1")+
scale_colour_manual(values = c("gold", "dark green", "deepskyblue"))+
theme_hc(style = "darkunica")
ggplot(iris,aes(x=Sepal.Length,y=Sepal.Width,color=Species))+
geom_point()+ geom_abline(slope = 0.92,intercept = -1.9,color="mediumorchid1")+
scale_colour_manual(values = c("gold", "light green", "deepskyblue"))+
theme_hc(style = "darkunica")
ggplot(iris,aes(x=Sepal.Length,y=Sepal.Width,color=Species))+
geom_point()+ geom_abline(slope = 0.92,intercept = -1.9,color="mediumorchid1")+
scale_colour_manual(values = c("gold", "springgreen", "deepskyblue"))+
theme_hc(style = "darkunica")
ggplot(iris,aes(x=Sepal.Length,y=Sepal.Width,color=Species))+
geom_point()+ geom_abline(slope = 0.92,intercept = -1.9,color="mediumorchid1")+
scale_colour_manual(values = c("yellow", "springgreen", "deepskyblue"))+
theme_hc(style = "darkunica")
ggplot(iris,aes(x=Sepal.Length,y=Sepal.Width,color=Species))+
geom_point(size=2)+ geom_abline(slope = 0.92,intercept = -1.9,color="mediumorchid1")+
scale_colour_manual(values = c("yellow", "springgreen", "deepskyblue"))+
theme_hc(style = "darkunica")
ggplot(iris,aes(x=Sepal.Length,y=Sepal.Width,color=Species))+
geom_point()+ geom_abline(slope = 0.92,intercept = -1.9,color="mediumorchid1")+
scale_colour_manual(values = c("yellow", "springgreen", "deepskyblue"))+
theme_hc(style = "darkunica")
ggsave("images/chap4-sepiris2.png",type="cairo-png",units="cm",width = 15,height = 8,dpi=300)
ggplot(iris,aes(x=Sepal.Length,y=Sepal.Width,color=Species))+
geom_point(shape=19)+ geom_abline(slope = 0.92,intercept = -1.9,color="mediumorchid1")+
scale_colour_manual(values = c("yellow", "springgreen", "deepskyblue"))+
theme_hc(style = "darkunica")
ggplot(iris,aes(x=Sepal.Length,y=Sepal.Width,color=Species))+
geom_point(shape=15)+ geom_abline(slope = 0.92,intercept = -1.9,color="mediumorchid1")+
scale_colour_manual(values = c("yellow", "springgreen", "deepskyblue"))+
theme_hc(style = "darkunica")
ggplot(iris,aes(x=Sepal.Length,y=Sepal.Width,color=Species))+
geom_point(shape=5)+ geom_abline(slope = 0.92,intercept = -1.9,color="mediumorchid1")+
scale_colour_manual(values = c("yellow", "springgreen", "deepskyblue"))+
theme_hc(style = "darkunica")
ggsave("images/chap4-sepiris2.png",type="cairo-png",units="cm",width = 15,height = 8,dpi=300)
>phi_heavi <- function(x){ifelse(x >=0,1,-1)}
phi_heavi <- function(x){ifelse(x >=0,1,-1)}
my_weights <- rnorm(196)
w <- matrix(my_weights,196,1)
as.vector(my.image.data) %*% w
library(magrittr)
set.seed(2600)
my.image.data <- c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,1,.9,.6,1,0,0,0,0,0,0,
0,0,0,0,1,0,1,1,0,0,0,0,0,0,
0,0,0,0,0.9,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,.7,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,.9,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0) %>%
as.vector(my.image.data) %*% w
matrix(.,14,14,byrow=T)
my.image.data <- c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,1,.9,.6,1,0,0,0,0,0,0,
0,0,0,0,1,0,1,1,0,0,0,0,0,0,
0,0,0,0,0.9,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,.7,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,.9,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0) %>%
matrix(.,14,14,byrow=T)
as.vector(my.image.data) %*% w
as.vector(x) %*% w %>% phi_heavi
as.vector(my.image.data) %*% w %>% phi_heavi
mark_i <- function(x, y, eta) {
# inicializa pesos randomicos de distribuicao normal
w <- rnorm(dim(x)[2]) # numero de pesos = numero de colunas em x
ypreds <- rep(0,dim(x)[1]) # inicializa predicoes em 0
# Processa as observacoes em x de forma aleatoria
for (i in sample(1:length(y),replace=F)) {
# predicao
ypred <- sum(w * as.numeric(x[i, ])) %>% phi_heavi
# update em w
delta_w <- eta * (y[i] - ypred) * as.numeric(x[i, ])
#nota: x[i,] sera multiplicado como matriz (dot product)
w <- w + delta_w
ypreds[i] <- ypred # salva predicao atual
}
print(paste("Weights: ",w))
return(ypreds)
}
train_df <- iris[1:100, c(1, 2, 5)]
train_df[, 4] <- -1
train_df[train_df[, 3] == "setosa", 4] <- 1
names(train_df) <- c("s.len", "s.wid", "species","target")
head(train_df)
y_preds <- mark_i(x_features, y_target, 0.002)
x_features <- train_df[, c(1, 2)]
y_target <- train_df[, 4]
y_preds <- mark_i(x_features, y_target, 0.002)
table(y_preds,train_df$target) # matriz de confusao
49+36/(36+49+1+14)
(49+36)/(36+49+1+14)
y_preds <- mark_i(x_features, y_target, 0.05)
table(y_preds,train_df$target)
(27+24)/(27+24+23+26)
y_preds <- mark_i(x_features, y_target, 0.1)
table(y_preds,train_df$target)
39+38/(39+3811+12)
39+38/(39+38+11+12)
(39+38)/(39+38+11+12)
y_preds <- mark_i(x_features, y_target, 0.01)
table(y_preds,train_df$target)
(43+49)/(43+49+8)
y_preds <- mark_i(x_features, y_target, 0.01)
table(y_preds,train_df$target)
y_preds <- mark_i(x_features, y_target, 0.01)
table(y_preds,train_df$target)
y_preds <- mark_i(x_features, y_target, 0.001)
table(y_preds,train_df$target)
y_preds <- mark_i(x_features, y_target, 0.05)
table(y_preds,train_df$target)
table(y_preds,train_df$target)
y_preds <- mark_i(x_features, y_target, 0.05)
table(y_preds,train_df$target)
y_preds <- mark_i(x_features, y_target, 0.05)
table(y_preds,train_df$target)
y_preds <- mark_i(x_features, y_target, 0.05)
table(y_preds,train_df$target)
y_preds <- mark_i(x_features, y_target, 0.02)
table(y_preds,train_df$target)
y_preds <- mark_i(x_features, y_target, 0.02)
y_preds <- mark_i(x_features, y_target, 0.02)
table(y_preds,train_df$target)
y_preds <- mark_i(x_features, y_target, 0.02)
table(y_preds,train_df$target)
y_preds <- mark_i(x_features, y_target, 0.02)
table(y_preds,train_df$target)
y_preds <- mark_i(x_features, y_target, 0.02)
table(y_preds,train_df$target)
y_preds <- mark_i(x_features, y_target, 0.02)
table(y_preds,train_df$target)
y_preds <- mark_i(x_features, y_target, 0.02)
table(y_preds,train_df$target)
y_preds <- mark_i(x_features, y_target, 0.02)
table(y_preds,train_df$target)
library(magrittr)
set.seed(2600)
my.image.data <- c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,1,.9,.6,1,0,0,0,0,0,0,
0,0,0,0,1,0,1,1,0,0,0,0,0,0,
0,0,0,0,0.9,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,.7,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,.9,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0) %>%
matrix(.,14,14,byrow=T)
phi_heavi <- function(x){ifelse(x >=0,1,-1)}
# Iniciando pesos com base em distribuição normal
my_weights <- rnorm(196)
w <- matrix(my_weights,196,1)
as.vector(my.image.data) %*% w
as.vector(my.image.data) %*% w %>% phi_heavi
train_df <- iris[1:100, c(1, 2, 5)]
train_df[, 4] <- -1
train_df[train_df[, 3] == "setosa", 4] <- 1
names(train_df) <- c("s.len", "s.wid", "species","target")
head(train_df)
train_df[60:65,]
x_features <- train_df[, c(1, 2)]
y_target <- train_df[, 4]
y_preds <- mark_i(x_features, y_target, 0.002)
mark_i
table(y_preds,train_df$target) # matriz de confusao
(27+45)+(27+45+23+5)
(27+45)/(27+45+23+5)
y_preds <- mark_i(x_features, y_target, 0.05)
table(y_preds,train_df$target)
(35+34)/(35+34+16+15)
y_preds <- mark_i(x_features, y_target, 0.1)
table(y_preds,train_df$target)
table(y_preds,train_df$target) *>* matrix(c(1,0,0,1)byrow = Y)
table(y_preds,train_df$target) *>* matrix(c(1,0,0,1)byrow = T)
table(y_preds,train_df$target) *** matrix(c(1,0,0,1)byrow = T)
table(y_preds,train_df$target) %*% matrix(c(1,0,0,1)byrow = T)
table(y_preds,train_df$target) %>% as.matrix %*% matrix(c(1,0,0,1)byrow = T)
table(y_preds,train_df$target) %>% as.matrix * matrix(c(1,0,0,1)byrow = T)
(31+29)/(31+29+21+19)
y_preds <- mark_i(x_features, y_target, 0.01)
table(y_preds,train_df$target)
(25+23)/(25+23+25+27)
y_preds <- mark_i(x_features, y_target, 0.01)
(25+23)/(25+23+25+27)
table(y_preds,train_df$target)
y_preds <- mark_i(x_features, y_target, 0.01)
table(y_preds,train_df$target)
y_preds <- mark_i(x_features, y_target, 0.01)
table(y_preds,train_df$target)
sys.call("ls")
sys.call("dir")
system("ls")
system("ls images")
library(pROC)
library(deepnet)
library(h2o)
library(ggplot2)
library(car)
normalize <- function(x){
x.mean <- mean(x)
x.std <- sd(x)
y <- vapply(X=x,
FUN=function(x) 1/x.std*(sqrt(2*pi)*exp((-0.5)*(x-x.mean/x.std)^2)),
FUN.VALUE=1)
return(y)
}
samples.ind <- sort(rnorm(n = 1000, mean=0, sd = 1.8))
inv.norm <- (-1)*normalize(samples.ind)
inv.norm <- inv.norm + rnorm(mean = 0,n = 1000,sd=0.2)
inv.normt <- inv.norm + 0.6
inv.both <- c(inv.norm,inv.normt)
names <- c(rep("1",1000),rep("2",1000))
ind <- c(1:1000,1:1000)
inv.ds <- data.frame(beta=inv.both,type=names,tempo=ind)
inv.ds$type_dic <- numeric(length=2000)
inv.ds$type_dic <- car::recode(inv.ds$type,"'1'=1;'2'=0")
plot_one <- ggplot(data=inv.ds,aes(y=beta,x=tempo,color=type))+
geom_point()+
ylab("Hormônio (Beta)")+xlab("Tempo (t)")+
scale_color_hue(name="Amostra",
labels=c("Sem esteroides","Esteroides"))+
scale_x_continuous(labels=NULL)
plot_one
normal <- rnorm(n = 1000,mean = -1)
over <-  rnorm(n = 1000)
hist(over)
hist(over)norm
hist(over)
hist(norm)
hist(normal)
hist(norm)
normal <- apply(1:1000, x^2)
dev.off()
normal <- apply(1:1000, x^2)
normal <- apply(1:1000, FUN = x^2)
normal <- apply(1:1000, FUN = function(x) x^2)
normal <- purrr::map(1:1000, FUN = function(x) x^2)
normal <- purrr::map(1:1000, .f function(x) x^2)
normal <- purrr::map(1:1000, .f =function(x) x^2)
normal
over <-  purrr::map(1:1000, .f =function(x) x^2 - 1)
over <-  purrr::map(1:1000, .f =function(x) x^2 +1)
normal <- purrr::map(1:1000, .f =function(x) x^2) + rnorm(1000)
over <-  purrr::map(1:1000, .f =function(x) x^2+1) + rnorm(1000)
over <-  (purrr::map(1:1000, .f =function(x) x^2+1) %>% as.numeric)+ rnorm(1000)
normal <- (purrr::map(1:1000, .f =function(x) x^2) %>% as.numeric)+ rnorm(1000)
over <-  (purrr::map(1:1000, .f =function(x) x^2+1) %>% as.numeric)+ rnorm(1000)
plot(normal)
plot(over)
normal <- (purrr::map(-500:500, .f =function(x) x^2) %>% as.numeric)+ rnorm(1000)
over <-  (purrr::map(-500:500, .f =function(x) x^2+1) %>% as.numeric)+ rnorm(1000)
normal <- (purrr::map(-500:500, .f =function(x) x^2) %>% as.numeric)+ rnorm(1000)
plot(over)
plot(normal)
plot(over)
horm_df <- data.frame(norm = normal, ov = over)
plot_one <- ggplot(data=horm_df,aes(y=norm,x=1:1000))+
geom_point()+
geom_point(data=horm_df,aes(y=over,x=1:1000))+
ylab("Hormônio (Beta)")+xlab("Tempo (t)")+
scale_color_hue(name="Amostra",
labels=c("Sem esteroides","Esteroides"))+
scale_x_continuous(labels=NULL)
plot_one
normal <- (purrr::map(-500:500, .f =function(x) x^2) %>% as.numeric)+ rnorm(1000)
over <-  (purrr::map(-500:500, .f =function(x) x^2+1) %>% as.numeric)+ rnorm(1000)
over
normal <- (purrr::map(-500:500, .f =function(x) x^2) %>% as.numeric)+ rnorm(1000)
normal <- (purrr::map(-500:500, .f =function(x) x^2) %>% as.numeric)+ rnorm(1001)
over <-  (purrr::map(-500:500, .f =function(x) x^2+1) %>% as.numeric)+ rnorm(1001)
plot_one <- ggplot(data=horm_df,aes(y=norm,x=1:1001))+
geom_point()+
geom_point(data=horm_df,aes(y=over,x=1:1001))+
ylab("Hormônio (Beta)")+xlab("Tempo (t)")+
scale_color_hue(name="Amostra",
labels=c("Sem esteroides","Esteroides"))+
scale_x_continuous(labels=NULL)
plot_one
plot_one <- ggplot(data=horm_df,aes(y=norm,x=1:1001))+
geom_point()+
geom_point(data=horm_df,aes(y=over,x=1:1001),color="red")+
ylab("Hormônio (Beta)")+xlab("Tempo (t)")+
scale_color_hue(name="Amostra",
labels=c("Sem esteroides","Esteroides"))+
scale_x_continuous(labels=NULL)
seq(-2,2,0.1)
seq(-2,2,0.1) %>% length()
plot(seq(-2,2,0.1))
plot(over)
normal <- (purrr::map(seq(-2,2,0.1), .f =function(x) x^2) %>% as.numeric)+ rnorm(1001)
normal <- (purrr::map(seq(-2,2,0.1), .f =function(x) x^2) %>% as.numeric)+ rnorm(41)
plot(over)
plot(normal)
normal <- (purrr::map(seq(-3,3,0.1), .f =function(x) x^2) %>% as.numeric)+ rnorm(41)
seq(-3,3,0.1) %>% length()
seq(-3,3,0.01) %>% length()
seq(-3,3,0.001) %>% length()
normal <- (purrr::map(seq(-3,3,0.01), .f =function(x) x^2) %>% as.numeric)+ rnorm(601)
over <-  (purrr::map(-3,3,0.01, .f =function(x) x^2+1) %>% as.numeric)+ rnorm(601)
over <-  (purrr::map(seq(-3,3,0.01), .f =function(x) x^2+1) %>% as.numeric)+ rnorm(601)
horm_df <- data.frame(norm = normal, ov = over)
plot_one <- ggplot(data=horm_df,aes(y=norm,x=1:601))+
geom_point()+
geom_point(data=horm_df,aes(y=over,x=1:601),color="red")+
ylab("Hormônio (Beta)")+xlab("Tempo (t)")+
scale_color_hue(name="Amostra",
labels=c("Sem esteroides","Esteroides"))+
scale_x_continuous(labels=NULL)
plot_one
ggplot(data=horm_df,aes(y=norm,x=1:601))+
geom_point(color="white")+
geom_point(data=horm_df,aes(y=over,x=1:601),color="yellow")+
ylab("Hormônio (Beta)")+xlab("Tempo (t)")+
scale_x_continuous(labels=NULL)
library(ggthemes)
ggplot(data=horm_df,aes(y=norm,x=1:601))+
geom_point(color="white")+
geom_point(data=horm_df,aes(y=over,x=1:601),color="yellow")+
ylab("Hormônio (Beta)")+xlab("Tempo (t)")+
scale_x_continuous(labels=NULL)+
theme_hc(style="darkunica")
ggplot(data=horm_df,aes(y=norm,x=1:601))+
geom_point(color="white",shape=5)+
geom_point(data=horm_df,aes(y=over,x=1:601),color="yellow",shape=5)+
ylab("Hormônio (Beta)")+xlab("Tempo (t)")+
scale_x_continuous(labels=NULL)+
theme_hc(style="darkunica")
normal <- (purrr::map(seq(-3,3,0.01), .f =function(x) x^2) %>% as.numeric)+ rnorm(601)
over <-  (purrr::map(seq(-3,3,0.01), .f =function(x) x^2+2) %>% as.numeric)+ rnorm(601)
horm_df <- data.frame(norm = normal, ov = over)
ggplot(data=horm_df,aes(y=norm,x=1:601))+
geom_point(color="white",shape=5)+
geom_point(data=horm_df,aes(y=over,x=1:601),color="yellow",shape=5)+
ylab("Hormônio (Beta)")+xlab("Tempo (t)")+
scale_x_continuous(labels=NULL)+
theme_hc(style="darkunica")
ggsave("images/chap4-hormones.png",type="cairo-png",units="cm",width = 15,height = 12,dpi=300)
class_df <- data.frame(measures=c(horm_df$norm,horm_df$ov),target=c(rep(1,601),rep(1,601)))
View(class_df)
class_df <- data.frame(measures=c(horm_df$norm,horm_df$ov),target=c(rep(0,601),rep(1,601)))
logist.fit <- glm(target ~ measures + time, family=binomial,data=class_df)
logist.fit <- glm(target ~ measures, family=binomial,data=class_df)
logist.fit
horm_df <- data.frame(norm = normal, ov = over,time=1:601)
class_df <- data.frame(measures=c(horm_df$norm,horm_df$ov),time=c(horm_df$time,horm_df$time),target=c(rep(0,601),rep(1,601)))
class_df
logist.fit <- glm(target ~ measures + time, family=binomial,data=class_df)
logist.fit
summary(logist.fit)
prob=predict(logist.fit,type=c("response"))
class_df$prob=prob
curve <- roc(type_dic ~ prob, data = class_df)
curve <- roc(target ~ prob, data = class_df)
curve
library(deepnet)
inv.ds$tempo.norm <- normalize(inv.ds$tempo)
class_df$tempo.norm <- normalize(horm_df)
library(caret)
names(class_df)
caret::train(x = class_df[,1:2], y=class_df$target,method="mlp",
size=2)
caret::train(x = class_df[,1:2], y=factor(class_df$target),method="mlp",
size=2)
class_df$time_sc <- scale(class_df$time)
caret::train(x = class_df[,1,5], y=factor(class_df$target),method="mlp",
size=2)
caret::train(x = class_df[,c(1,5)], y=factor(class_df$target),method="mlp",
size=2)
summary(curve)
plot(curve)
curve$thresholds
curve$sensitivities
curve$percent
curve$response
nn_horm <- caret::train(x = class_df[,c(1,5)], y=factor(class_df$target),method="mlp")
plot(nn_horm)
plot(nn_horm)
plot(nn_horm$finalModel)
nn_horm$finalModel
nn_horm$finalModel$nInputs
nn_horm$finalModel$nOutputs
nn_horm$finalModel$snnsObject
nn_horm$modelInfo
nn_horm$modelInfo$grid()
nn_horm$modelInfo$parameters
nn_horm$modelInfo$parameters$parameter
nn_horm$modelInfo$type
nn_horm$modelType
nn_horm$finalModel
nn_horm$finalModel$archParams
nn_horm$finalModel$param
