type = "closed"),
color = "white",
curvature = 0.2,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=3) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "grey25"),
panel.grid = element_blank())
ggplot(mark_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="gold",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "white",
curvature = 0.0,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=3) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "grey25"),
panel.grid = element_blank())
ggsave("images/chap4-nn.png",type="cairo-png",units="cm",dpi=300,width = 15,height=12)
ggplot(mark_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="light blue",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "white",
curvature = 0.0,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=3) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid = element_blank())
ggplot(mark_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="light blue",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "grey25",
curvature = 0.0,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=3) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid = element_blank())
ggplot(mark_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="light blue",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "grey50",
curvature = 0.0,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=3) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid = element_blank())
ggplot(mark_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="light blue",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "grey70",
curvature = 0.0,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=3) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid = element_blank())
ggplot(mark_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="light blue",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "grey70",
curvature = 0.8,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=3) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid = element_blank())
ggplot(mark_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="light blue",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "grey70",
curvature = 0.6,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=3) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid = element_blank())
ggplot(mark_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="light blue",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "grey70",
curvature = 0.2,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=3) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid = element_blank())
ggplot(mark_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="light blue",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "grey70",
curvature = 0.3,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=3) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid = element_blank())
mark_regn_plot
52+45
97/2
mark_regn_plot[3:4,1] <- c(0.485)
ggplot(mark_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="light blue",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "grey70",
curvature = 0.3,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=3) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid = element_blank())
ggplot(mark_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="light blue",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "grey70",
curvature = 0.3,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=3) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid = element_blank())
mark_regn_plot <- ggnetwork(mark_regn)
mark_regn_plot[3:4,1] <- c(0.485)
ggplot(mark_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="light blue",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "grey70",
curvature = 0.3,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=3) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid = element_blank())
mark_regn_plot
mark_regn_plot[c(3:4,10:11),1] <- c(0.485)
ggplot(mark_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="light blue",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "grey70",
curvature = 0.3,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=3) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid = element_blank())
mark_regn_plot <- ggnetwork(mark_regn)
mark_regn_plot
mark_regn_plot[c(3:4,10:11),c(1,5)] <- c(0.485)
ggplot(mark_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="light blue",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "grey70",
curvature = 0.3,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=3) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid = element_blank())
## Mark ii reg
mark_reg <- matrix(c(1,0,0,0,0,0,
1,1,0,0,0,0,
0,1,1,0,0,0,
0,1,0,1,0,0,
0,0,1,1,1,0,
0,0,0,0,1,1),ncol=6,nrow = 6)
mark_regn <- network(mark_reg)
set.vertex.attribute(mark_regn, attrname = "vertex.names",
value = c("X","W1","W21","W22","+","Y"))
mark_regn_plot
## Mark ii reg
mark_reg <- matrix(c(1,0,0,0,0,0,
1,1,0,0,0,0,
0,1,1,0,0,0,
0,1,0,1,0,0,
0,0,1,1,1,0,
0,0,0,0,1,1),ncol=6,nrow = 6)
mark_regn <- network(mark_reg)
set.vertex.attribute(mark_regn, attrname = "vertex.names",
value = c("X","W1","W21","W22","+","Y"))
mark_regn_plot <- ggnetwork(mark_regn)
mark_regn_plot
mark_regn_plot <- ggnetwork(mark_regn)
ggplot(mark_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="light blue",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "grey70",
curvature = 0.3,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=3) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid = element_blank())
??ggnetwork
mark_regn_plot <- ggnetwork(mark_regn)
ggplot(mark_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="light blue",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "grey70",
curvature = 0.3,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=3) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid = element_blank())
ggsave("images/chap4-nn.png",type="cairo-png",units="cm",dpi=300,width = 15,height=12)
library(network)
library(ggnetwork)
library(ggplot2)
sim_reg <- matrix(c(1,1,
0,1),ncol=2,nrow = 2)
sim_regn <- network(sim_reg)
set.vertex.attribute(sim_regn, attrname = "vertex.names",
value = c("Hale","Nº Médicos"))
sim_regn_plot <- ggnetwork(sim_regn)
ggplot(sim_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="gold",size=11) +
geom_edges(arrow = arrow(length = unit(5, "pt"),type = "closed"),
color = "white",
curvature = 0.1,size=0.25) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=1.35) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "grey25"),
panel.grid = element_blank())
## Mult reg
mult_reg <- matrix(c(1,1,1,
0,1,0,
0,0,1),ncol=3,nrow = 3)
mult_regn <- network(mult_reg)
set.vertex.attribute(mult_regn, attrname = "vertex.names",
value = c("Hale","Nº Médicos","IDH"))
mult_regn_plot <- ggnetwork(mult_regn)
ggplot(mult_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="gold",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "white",
curvature = 0.2,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=1.35) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "grey25"),
panel.grid = element_blank())
## CFA
cfa_reg <- matrix(c(1,0,0,0,0,0,1,
0,1,0,0,0,0,1,
0,0,1,0,0,1,0,
0,0,0,1,0,1,0,
0,0,0,0,1,1,0,
0,0,0,0,0,1,0,
0,0,0,0,0,0,1),ncol=7,nrow = 7)
cfa_regn <- network(cfa_reg)
set.vertex.attribute(cfa_regn, attrname = "vertex.names",
value = c("X1","X2","X3","X4","X5","F1","F2"))
cfa_regn_plot <- ggnetwork(cfa_regn)
ggplot(cfa_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="gold",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "white",
curvature = 0.5,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=1.35) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "grey25"),
panel.grid = element_blank())
## Cover
big_reg <- matrix(c(1,0,0,0,0,0,1,1,1,1,
0,1,0,0,0,0,1,1,1,1,
0,0,1,0,0,1,0,1,0,0,
0,0,0,1,0,1,0,0,0,0,
0,0,0,0,1,1,0,0,0,0,
0,1,1,0,0,1,0,0,0,0,
0,0,0,0,0,0,1,1,1,1,
0,0,1,0,0,0,1,1,1,1,
0,1,0,0,0,0,1,1,1,1,
0,0,0,0,0,0,1,1,1,1),ncol=10,nrow = 10)
big_regn <- network(big_reg)
set.vertex.attribute(big_regn, attrname = "vertex.names",
value = c(""))
big_regn_plot <- ggnetwork(big_regn)
ggplot(big_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="gold",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "white",
curvature = 0.3,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=1.35) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "grey25"),
panel.grid = element_blank())
## Mark ii reg
mark_reg <- matrix(c(1,0,0,0,0,0,
1,1,0,0,0,0,
0,1,1,0,0,0,
0,1,0,1,0,0,
0,0,1,1,1,0,
0,0,0,0,1,1),ncol=6,nrow = 6)
mark_regn <- network(mark_reg)
set.vertex.attribute(mark_regn, attrname = "vertex.names",
value = c("X","W1","W21","W22","+","Y"))
mark_regn_plot <- ggnetwork(mark_regn)
ggplot(mark_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="light blue",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "grey70",
curvature = 0.3,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=3) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white"),
panel.grid = element_blank())
## Med
mult_reg <- matrix(c(1,1,1,
0,1,1,
0,0,1),ncol=3,nrow = 3)
mult_regn <- network(mult_reg)
set.vertex.attribute(mult_regn, attrname = "vertex.names",
value = c("Hale","Nº Médicos","IDH"))
mult_regn_plot <- ggnetwork(mult_regn)
ggplot(mult_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="gold",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "white",
curvature = 0.2,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=1.35) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "grey25"),
panel.grid = element_blank())
## Med
mult_reg <- matrix(c(1,0,0,
1,1,0,
1,1,1),ncol=3,nrow = 3)
mult_regn <- network(mult_reg)
## Med
mult_reg <- matrix(c(1,0,0,
1,1,0,
1,1,1),ncol=3,nrow = 3)
mult_regn <- network(mult_reg)
set.vertex.attribute(mult_regn, attrname = "vertex.names",
value = c("X","Mediador","Y"))
mult_regn_plot <- ggnetwork(mult_regn)
ggplot(mult_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="gold",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "white",
curvature = 0.2,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=1.35) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "grey25"),
panel.grid = element_blank())
ggsave("images/chap3-med.png",type="cairo-png",units="cm",dpi=300,width = 15,height=12)
ggsave("images/chap3-med.png",type="cairo-png",units="cm",dpi=300,width = 12,height=8)
ggsave("images/chap3-med.png",type="cairo-png",units="cm",dpi=300,width = 10,height=7)
sobel()
psych::i
lm(Sepal.Length ~ Sepal.Width,data = iris)
fit1 <- lm(Sepal.Length ~ Sepal.Width,data = iris)
install.packages("multileve")
install.packages("multilevel")
?multilevel::sobel
sobel(pred=bh1996$HRS,med=bh1996$LEAD,out=bh1996$WBEING)
multilevel::sobel(pred=bh1996$HRS,med=bh1996$LEAD,out=bh1996$WBEING)
data(bh1996)
library(multilevel)
data(bh1996)
multilevel::sobel(pred=bh1996$HRS,med=bh1996$LEAD,out=bh1996$WBEING)
multilevel::sobel(pred=bh1996$HRS,med=bh1996$LEAD,out=bh1996$WBEING)
0.043 - 0.0652
multilevel::sobel(pred=bh1996$HRS,med=bh1996$LEAD,out=bh1996$WBEING) %>% summary
library(magrittr)
multilevel::sobel(pred=bh1996$HRS,med=bh1996$LEAD,out=bh1996$WBEING) %>% summary
multilevel::sobel(pred=bh1996$HRS,med=bh1996$LEAD,out=bh1996$WBEING) %>% plot
multilevel::sobel(pred=bh1996$HRS,med=bh1996$LEAD,out=bh1996$WBEING) %>% print
install.packages("bda")
bda::mediation.test(iv = bh1996$HRS,mv = bh1996$LEAD,dv = bh1996$WBEING)
multilevel::sobel(pred=bh1996$HRS,med=bh1996$LEAD,out=bh1996$WBEING) %>% print
bda::mediation.test(iv = bh1996$HRS,mv = bh1996$LEAD,dv = bh1996$WBEING)
fit_yx1 <- lm(WBEING ~ bh1996$HRS, bh1996)
>fit_yx1 <- lm(WBEING ~ HRS, bh1996)
>fit_yx2 <- lm(WBEING ~ LEAD, data)
# Mediation
>fit_yx1x2 <- lm(WBEING ~ HRS + LEAD)
fit_yx1 <- lm(WBEING ~ bh1996$HRS, bh1996)
fit_yx2 <- lm(WBEING ~ LEAD, data)
fit_yx2 <- lm(WBEING ~ LEAD, bh1996)
fit_yx2 <- lm(WBEING ~ HRS + LEAD , bh1996)
multilevel::sobel(pred=bh1996$HRS,med=bh1996$LEAD,out=bh1996$WBEING) %>% print
multilevel::sobel(pred=bh1996$HRS,med=bh1996$LEAD,out=bh1996$WBEING)
sobel(pred=bh1996$HRS,med=bh1996$LEAD,out=bh1996$WBEING)
sobel(pred=bh1996$HRS,med=bh1996$LEAD,out=bh1996$WBEING)
?bh1996
bh1996$LEAD
