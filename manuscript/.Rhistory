xlab("Posteriors")+ylab("Density")+
geom_text(label="Posterior ($\mu$ = 0):\n -0.557",
color="white",x=0+0.05,y=2000)
ggplot(data = data.frame(posteriors_data), aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
theme_hc(style = "darkunica") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green")+
xlab("Posteriors")+ylab("Density")+
geom_text(label="Posterior ($\mu$ = 0):\n -0.557",
color="white",x=0,y=2000)
ggplot(data = data.frame(posteriors_data), aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
theme_hc(style = "darkunica") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green")+
xlab("Posteriors")+ylab("Density")+
geom_text(label="Posterior ($\mu$ = 0):\n -0.557",color="white",x=0,y=2000)
ggplot(data = data.frame(posteriors_data), aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
theme_hc(style = "darkunica") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green")+
xlab("Posteriors")+ylab("Density")+
geom_text(label="Posterior (\mu = 0):\n -0.557",color="white",x=0,y=2000)
ggplot(data = data.frame(posteriors_data), aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
theme_hc(style = "darkunica") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green")+
xlab("Posteriors")+ylab("Density")+
geom_text(label="Posterior (mu = 0):\n -0.557",color="white",x=0,y=2000)
ggplot(data = data.frame(posteriors_data), aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
theme_hc(style = "darkunica") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green")+
xlab("Posteriors")+ylab("Density")+
geom_text(label="Posterior (mu = 0):\n -0.557",color="white",x=0,y=1)
ggplot(data = data.frame(posteriors_data), aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
theme_hc(style = "darkunica") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green")+
xlab("Posteriors")+ylab("Density")+
geom_text(label="Posterior (mu = 0):\n -0.557",color="white",x=0.2,y=1)
ggplot(data = data.frame(posteriors_data), aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
theme_hc(style = "darkunica") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green")+
xlab("Posteriors")+ylab("Density")+
geom_text(label="Posterior (mu = 0):\n -0.557",color="white",x=-0.2,y=1)
ggplot(data = data.frame(posteriors_data), aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
theme_hc(style = "darkunica") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green")+
xlab("Posteriors")+ylab("Density")+
geom_text(label="Posterior A",color="white",x=-0.2,y=1)
mean(a)
ggplot(data = data.frame(posteriors_data), aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
theme_hc(style = "darkunica") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green")+
xlab("Posteriors")+ylab("Density")+
geom_text(label="Posterior A \n ~ 0",color="white",x=-0.2,y=1)
mean(posterior_b)
ggplot(data = data.frame(posteriors_data), aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
theme_hc(style = "darkunica") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green")+
xlab("Posteriors")+ylab("Density")+
geom_text(label="Posterior A \n μ ~ 0.07",color="white",x=-0.2,y=1)+
geom_text(label="Posterior b \n μ ~ 0.57",color="white",x=-0.2,y=1)
ggplot(data = data.frame(posteriors_data), aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
theme_hc(style = "darkunica") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green")+
xlab("Posteriors")+ylab("Density")+
geom_text(label="Posterior A \n μ ~ 0.07",color="white",x=-0.2,y=1)+
geom_text(label="Posterior b \n μ ~ 0.57",color="white",x=1,y=1)
mean(posterior_b - posterior_a)
mean(posterior_a - posterior_b)
mean(posterior_b - posterior_a)
ggplot(data = data.frame(posteriors_data), aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
theme_hc(style = "darkunica") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Density") +
geom_text(label="Posterior A \n μ ~ 0.07",color="white",x=-0.2,y=1)+
geom_text(label="Posterior b \n μ ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior b \n μ ~ 0.49",color="white",x=0,y=1)
ggplot(data = data.frame(posteriors_data), aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
theme_hc(style = "darkunica") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Density") +
geom_text(label="Posterior A \n μ ~ 0.07",color="white",x=-0.2,y=1)+
geom_text(label="Posterior b \n μ ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior b \n μ ~ 0.49",color="white",x=0.3,y=0.3)
ggplot(data = data.frame(posteriors_data), aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
theme_hc(style = "darkunica") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Density") +
geom_text(label="Posterior A \n μ ~ 0.07",color="white",x=-0.2,y=1)+
geom_text(label="Posterior B \n μ ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior difference \n μ ~ 0.49",color="white",x=0.3,y=0.3)
57-6
57-7
mean(posterior_b)
mean(posterior_a)
mean(posterior_b - posterior_a)
ggplot(data = data.frame(posteriors_data), aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
theme_hc(style = "darkunica") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Density") +
geom_text(label="Posterior A \n μ ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="Posterior B \n μ ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior difference \n μ ~ 0.49",color="white",x=0.3,y=0.3)
ggplot(data = data.frame(posteriors_data), aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
theme_hc(style = "darkunica") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Density") +
geom_text(label="P(B|X) \n μ ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(A|X) \n μ ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior of difference \n μ ~ 0.49",color="white",x=0.3,y=0.3)
ggsave("images/chap5-posterior_diff_mcmc.png",type="cairo-png",units="cm",width = 15,height = 10,dpi=300)
ggplot(data = data.frame(posteriors_data), aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
theme_hc(style = "darkunica") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Density") +
geom_text(label="P(A|X) \n μ ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n μ ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior of difference \n μ ~ 0.49",color="white",x=0.3,y=0.3)
ggsave("images/chap5-posterior_diff_mcmc.png",type="cairo-png",units="cm",width = 15,height = 10,dpi=300)
mean(a)
mean(b)
mean(b - a)
mean(posterior_b - posterior_a)
quantile((posterior_b - posterior_a),probs = c(0.25,0.5,0.75))
quantile((posterior_b - posterior_a),probs = c(0.225,0.5,0.975))
quantile((posterior_b - posterior_a),probs = c(0.025,0.5,0.975))
set.seed(2600)
a <- rnorm(n=n_obs, sd =1, mean=0)
n_obs=400
a <- rnorm(n=n_obs, sd =1, mean=0)
b <- rnorm(n=n_obs, sd=1, mean=0.6)
likel <- function(n,x,mu,sigma){
l_val <- (-n/2)*log(2*pi*sigma^2) - (1/2*sigma^2)*sum((x - mu)^2)
return(-l_val) # multiplica(-1)
}
log_norm <- function(n,mu,sigma){
require(magrittr) # para o operador %>%
# Truque para obter distribuicao ~ uniforme em [-Inf,+Inf]
unif_dist <- 1/runif(n = n, min = -1,max = 1)
l_val <- dnorm(x=unif_dist,mean = 0,sd = 1, log=T)
l_val <- car::recode(l_val,"-Inf:-1000=-1000") %>% sum # recod. valores extremos
return(-l_val)
}
mc_chain <- function(obs,iter=4000,n_obs=length(obs)){
# seeds e objetos
sample <- matrix(nrow = iter, ncol = 2)
s1_mu <- rnorm(n=1,mean=0) # media inicial
s_sigma <- 1 # variancia = 1
s1_lik <- 2000
for (i in 1:iter){
# Salva estado
s0_mu <- s1_mu
s0_lik <- s1_lik
# Realiza um passo (random walk)
s1_mu <- s1_mu + rnorm(n=1,mean = 0, sd=0.5)
s1_lik <- likel(n=n_obs,x=obs,mu=s1_mu,sigma=s_sigma) +
# log do prior é normalizado por 1000
log_norm(n=10000,mu=0,sigma=1)/1000
# Rejeita diferenças maiores que 5, assumindo o valor no estado anterior
if(s1_lik - s0_lik > 5)
s1_mu <- s0_mu
sample[i,] <- c(s1_mu,s_sigma) # Salva
}
return(sample[1001:iter,1]) # Descarta as primeiras 1000 amostras (warm-up)
}
posterior_a <- mc_chain(obs = a,iter = 4000)
posterior_b <- mc_chain(obs = b,iter = 4000)
posteriors_data <- data.frame(post_a=posterior_a, post_b=posterior_b)
library(ggplot2)
library(ggthemes)
ggplot(data = posteriors_data, aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Density") +
geom_text(label="P(A|X) \n mu ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n mu ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior of difference \n mu ~ 0.49",color="white",x=0.3,y=0.3)+
theme_hc(style = "darkunica")
library(cowplot)
library(ggthemes)
ggplot(data = posteriors_data, aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Density") +
geom_text(label="P(A|X) \n mu ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n mu ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior of difference \n mu ~ 0.49",color="white",x=0.3,y=0.3)+
theme_hc(style = "darkunica")
.rs.restartR()
set.seed(2600)
n_obs <- 400
a <- rnorm(n=n_obs, sd =1, mean=0)
b <- rnorm(n=n_obs, sd=1, mean=0.6)
likel <- function(n,x,mu,sigma){
l_val <- (-n/2)*log(2*pi*sigma^2) - (1/2*sigma^2)*sum((x - mu)^2)
return(-l_val) # multiplica(-1)
}
log_norm <- function(n,mu,sigma){
require(magrittr) # para o operador %>%
# Truque para obter distribuicao ~ uniforme em [-Inf,+Inf]
unif_dist <- 1/runif(n = n, min = -1,max = 1)
l_val <- dnorm(x=unif_dist,mean = 0,sd = 1, log=T)
l_val <- car::recode(l_val,"-Inf:-1000=-1000") %>% sum # recod. valores extremos
return(-l_val)
}
mc_chain <- function(obs,iter=4000,n_obs=length(obs)){
# seeds e objetos
sample <- matrix(nrow = iter, ncol = 2)
s1_mu <- rnorm(n=1,mean=0) # media inicial
s_sigma <- 1 # variancia = 1
s1_lik <- 2000
for (i in 1:iter){
# Salva estado
s0_mu <- s1_mu
s0_lik <- s1_lik
# Realiza um passo (random walk)
s1_mu <- s1_mu + rnorm(n=1,mean = 0, sd=0.5)
s1_lik <- likel(n=n_obs,x=obs,mu=s1_mu,sigma=s_sigma) +
# log do prior é normalizado por 1000
log_norm(n=10000,mu=0,sigma=1)/1000
# Rejeita diferenças maiores que 5, assumindo o valor no estado anterior
if(s1_lik - s0_lik > 5)
s1_mu <- s0_mu
sample[i,] <- c(s1_mu,s_sigma) # Salva
}
return(sample[1001:iter,1]) # Descarta as primeiras 1000 amostras (warm-up)
}
posterior_a <- mc_chain(obs = a,iter = 4000)
posterior_b <- mc_chain(obs = b,iter = 4000)
posteriors_data <- data.frame(post_a=posterior_a, post_b=posterior_b)
library(ggplot2)
library(ggthemes)
posts_plot <- ggplot(data = posteriors_data, aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Density") +
geom_text(label="P(A|X) \n mu ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n mu ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior of difference \n mu ~ 0.49",color="white",x=0.3,y=0.3)+
theme_hc(style = "darkunica")
ggplot(data=posteriors_data,aes(y=posterior_a))
ggplot(data=posteriors_data,aes(y=posterior_a))+geom_line
ggplot(data=posteriors_data,aes(y=posterior_a))+geom_line(
)
ggplot(data=posteriors_data,aes(y=posterior_a,x=1:nrow(posteriors_data)))+geom_line()
ggplot(data=posteriors_data,
aes(y=posterior_a,x=1:nrow(posteriors_data)))+
geom_line()+xlab("A Chain")+ylab("")+
theme_hc("style="darkunica")
ggplot(data=posteriors_data,
aes(y=posterior_a,x=1:nrow(posteriors_data)))+
geom_line()+xlab("A Chain")+ylab("")+
theme_hc(style="darkunica")
ggplot(data=posteriors_data,
aes(y=posterior_a,x=1:nrow(posteriors_data)))+
geom_line()+xlab("A Chain")+ylab("")+
theme_hc(style = "darkunica")
ggplot(data = posteriors_data, aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Density") +
geom_text(label="P(A|X) \n mu ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n mu ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior of difference \n mu ~ 0.49",color="white",x=0.3,y=0.3)+
theme_hc(style = "darkunica")
unloadNamespace("cowplot")
ggplot(data = posteriors_data, aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Density") +
geom_text(label="P(A|X) \n mu ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n mu ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior of difference \n mu ~ 0.49",color="white",x=0.3,y=0.3)+
theme_hc(style = "darkunica")
library(ggthemes)
ggplot(data = posteriors_data, aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Density") +
geom_text(label="P(A|X) \n mu ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n mu ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior of difference \n mu ~ 0.49",color="white",x=0.3,y=0.3)+
theme_hc(style = "darkunica")
library(ggthemes)
detach("package:cowplot", unload=TRUE)
detach("cowplot", unload=TRUE)
detach("package::cowplot", unload=TRUE)
detach(package:cowplot)
?detach()
detach(name = package:cowplot)
detach(name = package:ggplot2)
ggplot(data = posteriors_data, aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Density") +
geom_text(label="P(A|X) \n mu ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n mu ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior of difference \n mu ~ 0.49",color="white",x=0.3,y=0.3)+
theme_hc(style = "darkunica")
library(ggplot2)
ggplot(data = posteriors_data, aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Density") +
geom_text(label="P(A|X) \n mu ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n mu ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior of difference \n mu ~ 0.49",color="white",x=0.3,y=0.3)+
theme_hc(style = "darkunica")
library(ggthemes)
ggplot(data = posteriors_data, aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Density") +
geom_text(label="P(A|X) \n mu ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n mu ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior of difference \n mu ~ 0.49",color="white",x=0.3,y=0.3)+
theme_hc(style = "darkunica")
.rs.restartR()
library(ggplot2)
library(ggthemes)
ggplot(data = posteriors_data, aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Density") +
geom_text(label="P(A|X) \n mu ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n mu ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior of difference \n mu ~ 0.49",color="white",x=0.3,y=0.3)+
theme_hc(style = "darkunica")
ggplot(data=posteriors_data,
aes(y=posterior_a,x=1:nrow(posteriors_data)))+
geom_line()+xlab("A Chain")+ylab("")+
theme_hc(style="darkunica")
ggplot(data=posteriors_data,
aes(y=posterior_a,x=1:nrow(posteriors_data)))+
geom_line(color="light green")+xlab("A Chain")+ylab("")+
geom_line(color="dark green")+xlab("B Chain")+ylab("")+
theme_hc(style="darkunica")
ggplot(data=posteriors_data,
aes(y=posterior_a,x=1:nrow(posteriors_data)))+
geom_line(color="light green")+xlab("A Chain")+ylab("")+
geom_line(color="purple")+xlab("B Chain")+ylab("")+
theme_hc(style="darkunica")
ggplot(data=posteriors_data,
aes(y=posterior_a,x=1:nrow(posteriors_data)))+
geom_line(color="light green")+xlab("A Chain")+ylab("")+
geom_line(aes(y=posterior_b,x=1:nrow(posteriors_data)),
color="dark green")+xlab("B Chain")+ylab("")+
theme_hc(style="darkunica")
posts_plot
posts_plot <- ggplot(data = posteriors_data, aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Density") +
geom_text(label="P(A|X) \n mu ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n mu ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior of difference \n mu ~ 0.49",color="white",x=0.3,y=0.3)+
theme_hc(style = "darkunica")
traces_plot <- ggplot(data=posteriors_data,
aes(y=posterior_a,x=1:nrow(posteriors_data)))+
geom_line(color="light green")+xlab("Chains")+ylab("")+
geom_line(aes(y=posterior_b,x=1:nrow(posteriors_data)),
color="dark green")+xlab("B Chain")+ylab("")+
theme_hc(style="darkunica")
source('~/dev-playground/stat-learn/manuscript/aux/multiplot.R')
multiplot(posts_plot,traces_plot,cols = 1)
traces_plot <- ggplot(data=posteriors_data,
aes(y=posterior_a,x=1:nrow(posteriors_data)))+
geom_line(color="light green")+xlab("Chains")+ylab("")+
geom_line(aes(y=posterior_b,x=1:nrow(posteriors_data)),
color="dark green")+
theme_hc(style="darkunica")
multiplot(posts_plot,traces_plot,cols = 1)
ggsave("images/chap5-posterior_diff_mcmc.png",type="cairo-png",units="cm",width = 15,height = 15,dpi=300)
posts_plot <- ggplot(data = posteriors_data, aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Densidade") +
geom_text(label="P(A|X) \n mu ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n mu ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior da diferença \n mu ~ 0.49",color="white",x=0.3,y=0.3)+
theme_hc(style = "darkunica")
ggplot(data = posteriors_data, aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Densidade") +
geom_text(label="P(A|X) \n mu ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n mu ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior da diferença \n mu ~ 0.49",color="white",x=0.3,y=0.3)+
theme_hc(style = "darkunica")
posts_plot <- ggplot(data = posteriors_data, aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Densidade") +
geom_text(label="P(A|X) \n mu ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n mu ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior da diferença \n mu ~ 0.49",color="white",x=0.3,y=0.3)+
theme_hc(style = "darkunica")
traces_plot <- ggplot(data=posteriors_data,
aes(y=posterior_a,x=1:nrow(posteriors_data)))+
geom_line(color="light green")+xlab("Chains")+ylab("")+
geom_line(aes(y=posterior_b,x=1:nrow(posteriors_data)),
color="dark green")+
theme_hc(style="darkunica")
multiplot(posts_plot,traces_plot,cols = 1)
sd(posterior_a)
sd(posterior_b)
sd(posterior_b - posterior_a)
mean(a)
meanb(b)
mean(b)
0.5*0.5
0.5*0.5
n_moment <- function(x,n) {(x- mean(x))^n}
n_moment(rnorm(10))
n_moment(rnorm(10),1)
n_moment <- function(x,n) {sum((x- mean(x))^n)}
n_moment(rnorm(10),1)
n_moment(rnorm(0),1)
n_moment(rnorm(100),1)
n_moment(rnorm(10),1)
n_moment(rnorm(5),1)
n_moment(rnorm(10),1)
n_moment(rnorm(mean = 2,10),1)
n_moment(rnorm(mean = 3,10),1)
n_moment(rnorm(10),1)
n_moment(rnorm(10),2)
n_moment(rnorm(10),2)
n_moment(rnorm(10),2)
n_moment(rnorm(10),2)
n_moment(rnorm(10),2)
n_moment(rnorm(100),2)
n_moment(rnorm(1000),2)
n_moment(rnorm(10000),2)
n_moment <- function(x,n) {sum((x- mean(x))^n)/length(x)}
n_moment(rnorm(1000),2)
n_moment(rnorm(1000),2)
n_moment(rnorm(1000),2)
n_moment(rnorm(1000),2)
n_moment(rnorm(1000),1)
n_moment(rnorm(1000),1)
n_moment(rnorm(1000),3)
n_moment(rnorm(1000),3)/n_moment(rnorm(1000),2)^(3/2)
e1071::skewness(rnorm(1000))
princomp(iris[,4])
princomp(iris[,1:4],)
princomp(iris[,1:4]) %>% summary
a <- princomp(iris[,1:4],)
a$loadings
a$scores
a$loadings %>% class
library(magrittr)
a$loadings %>% class
a$loadings %>% type
a$loadings %>% typeof
a$loadings %>% class
a$loadings[1] %>% class
library(rstan)
library(BEST)
?BEST::BESTmcmc()
1e+05
1e+05 + 1
<- BEST::BESTmcmc(y1 = iris$Sepal.Length,y2 = iris$Sepal.Width,
numSavedSteps = 3000)
a <- BEST::BESTmcmc(y1 = iris$Sepal.Length,y2 = iris$Sepal.Width,
numSavedSteps = 3000)
a$mu1
a$nu
a
