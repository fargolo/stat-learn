## Mult reg
mult_reg <- matrix(c(1,1,1,
0,1,0,
0,0,1),ncol=3,nrow = 3)
mult_regn <- network(mult_reg)
set.vertex.attribute(mult_regn, attrname = "vertex.names",
value = c("Hale","Nº Médicos","IDH"))
mult_regn_plot <- ggnetwork(mult_regn)
ggplot(mult_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="gold",size=22) +
geom_edges(arrow = arrow(length = unit(8, "pt"),
type = "closed"),
color = "white",
curvature = 0.2,size=0.3) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=2.7) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "grey25"),
panel.grid = element_blank())
ggsave("images/chap3-three-node-diagram.png",type="cairo-png",units="cm",width = 6,height = 5)
ggplot(sim_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="gold",size=22) +
geom_edges(arrow = arrow(length = unit(10, "pt"),type = "closed"),
color = "white",
curvature = 0.1,size=0.5) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=2.7) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "grey25"),
panel.grid = element_blank())
ggplot(sim_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="gold",size=11) +
geom_edges(arrow = arrow(length = unit(10, "pt"),type = "closed"),
color = "white",
curvature = 0.1,size=0.5) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=1.35) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "grey25"),
panel.grid = element_blank())
ggplot(sim_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="gold",size=11) +
geom_edges(arrow = arrow(length = unit(5, "pt"),type = "closed"),
color = "white",
curvature = 0.1,size=0.25) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=1.35) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "grey25"),
panel.grid = element_blank())
ggsave("images/chap3-two-node-diagram.png",type="cairo-png",units="cm",width = 6,height = 5)
ggplot(mult_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="gold",size=11) +
geom_edges(arrow = arrow(length = unit(8, "pt"),
type = "closed"),
color = "white",
curvature = 0.2,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=1.35) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "grey25"),
panel.grid = element_blank())
ggsave("images/chap3-three-node-diagram.png",type="cairo-png",units="cm",width = 6,height = 5)
ggplot(mult_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="gold",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "white",
curvature = 0.2,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=1.35) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "grey25"),
panel.grid = element_blank())
ggsave("images/chap3-three-node-diagram.png",type="cairo-png",units="cm",width = 6,height = 5)
## CFA
cfa_reg <- matrix(c(1,0,0,0,0,0,
0,1,0,0,0,0,
0,0,1,0,0,0,
0,0,0,1,0,0,
0,0,0,0,1,0,
0,0,0,0,0,1),ncol=6,nrow = 6)
mult_regn <- network(cfa_reg)
set.vertex.attribute(mult_regn, attrname = "vertex.names",
value = c("X1","X2","X3","X4","F1","F2"))
cfa_regn <- network(cfa_reg)
set.vertex.attribute(cfa_regn, attrname = "vertex.names",
value = c("X1","X2","X3","X4","F1","F2"))
mult_regn_plot <- ggnetwork(cfa_regn)
cfa_regn <- network(cfa_reg)
set.vertex.attribute(cfa_regn, attrname = "vertex.names",
value = c("X1","X2","X3","X4","F1","F2"))
mult_regn_plot <- ggnetwork(cfa_regn)
## CFA
cfa_reg <- matrix(c(1,0,0,0,0,0,
0,1,0,0,0,0,
0,0,1,0,0,0,
0,0,0,1,0,0,
0,0,0,0,1,0,
0,0,0,0,0,1),ncol=6,nrow = 6)
cfa_regn <- network(cfa_reg)
## CFA
cfa_reg <- matrix(c(1,0,0,0,0,0,
0,1,0,0,0,0,
0,0,1,0,0,0,
0,0,0,1,0,0,
1,1,0,0,1,0,
0,0,1,1,0,1),ncol=6,nrow = 6)
cfa_regn <- network(cfa_reg)
set.vertex.attribute(cfa_regn, attrname = "vertex.names",
value = c("X1","X2","X3","X4","F1","F2"))
mult_regn_plot <- ggnetwork(cfa_regn)
cfa_regn_plot <- ggnetwork(cfa_regn)
ggplot(cfa_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="gold",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "white",
curvature = 0.2,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=1.35) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "grey25"),
panel.grid = element_blank())
## CFA
cfa_reg <- matrix(c(1,0,0,0,0,1,
0,1,0,0,0,1,
0,0,1,0,1,0,
0,0,0,1,1,0,
0,0,0,0,1,0,
0,0,0,0,0,1),ncol=6,nrow = 6)
cfa_regn <- network(cfa_reg)
set.vertex.attribute(cfa_regn, attrname = "vertex.names",
value = c("X1","X2","X3","X4","F1","F2"))
cfa_regn_plot <- ggnetwork(cfa_regn)
ggplot(cfa_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="gold",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "white",
curvature = 0.2,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=1.35) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "grey25"),
panel.grid = element_blank())
cfa_regn <- network(cfa_reg)
set.vertex.attribute(cfa_regn, attrname = "vertex.names",
value = c("X1","X2","X3","X4","F1","F2"))
cfa_regn_plot <- ggnetwork(cfa_regn)
ggplot(cfa_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="gold",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "white",
curvature = 0.2,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=1.35) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "grey25"),
panel.grid = element_blank())
## CFA
cfa_reg <- matrix(c(1,0,0,0,0,1,
0,1,0,0,0,1,
0,0,1,0,1,0,
0,0,0,1,1,0,
0,0,0,0,1,0,
0,0,0,0,0,1),ncol=6,nrow = 6)
cfa_regn <- network(cfa_reg)
set.vertex.attribute(cfa_regn, attrname = "vertex.names",
value = c("X1","X2","X3","X4","F1","F2"))
cfa_regn_plot <- ggnetwork(cfa_regn)
ggplot(cfa_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="gold",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "white",
curvature = 0.2,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=1.35) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "grey25"),
panel.grid = element_blank())
ggsave("images/chap3-cfa.png",type="cairo-png",units="cm",dpi=300,width = 6,height = 5)
## CFA
cfa_reg <- matrix(c(1,0,0,0,0,0,1,
0,1,0,0,0,0,1,
0,0,1,0,0,1,0,
0,0,0,1,0,1,0,
0,0,0,0,1,1,0,
0,0,0,0,0,1,0,
0,0,0,0,0,0,1),ncol=6,nrow = 6)
## CFA
cfa_reg <- matrix(c(1,0,0,0,0,0,1,
0,1,0,0,0,0,1,
0,0,1,0,0,1,0,
0,0,0,1,0,1,0,
0,0,0,0,1,1,0,
0,0,0,0,0,1,0,
0,0,0,0,0,0,1),ncol=7,nrow = 7)
cfa_regn <- network(cfa_reg)
set.vertex.attribute(cfa_regn, attrname = "vertex.names",
value = c("X1","X2","X3","X4","X5","F1","F2"))
cfa_regn_plot <- ggnetwork(cfa_regn)
ggplot(cfa_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="gold",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "white",
curvature = 0.2,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=1.35) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "grey25"),
panel.grid = element_blank())
## CFA
cfa_reg <- matrix(c(1,0,0,0,0,0,1,
0,1,0,0,0,0,1,
0,0,1,0,0,1,0,
0,0,0,1,0,1,0,
0,0,0,0,1,1,0,
0,0,0,0,0,1,0,
0,0,0,0,0,0,1),ncol=7,nrow = 7)
cfa_regn <- network(cfa_reg)
set.vertex.attribute(cfa_regn, attrname = "vertex.names",
value = c("X1","X2","X3","X4","X5","F1","F2"))
cfa_regn_plot <- ggnetwork(cfa_regn)
ggplot(cfa_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="gold",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "white",
curvature = 0.2,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=1.35) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "grey25"),
panel.grid = element_blank())
ggsave("images/chap3-cfa.png",type="cairo-png",units="cm",dpi=300,width = 6,height = 5)
library(psych)
psych::fa(cov(iris[,1:4]))
psych::fa(cov(iris[,1:4]),nfactors = 2)
psych::fa(cov(iris[,1:4]),nfactors = 3)
psych::fa(cov(iris[,1:4]),nfactors = 3)
psych::fa(cov(iris[,1:4]),nfactors = 2)
psych::fa(cov(iris[,1:4]),nfactors = 3)
library(lavaan)
ggplot(cfa_regn_plot, aes(x = x, y = y,
xend = xend, yend = yend)) +
geom_nodes(color="gold",size=11) +
geom_edges(arrow = arrow(length = unit(4, "pt"),
type = "closed"),
color = "white",
curvature = 0.5,size=0.15) +
geom_nodetext(aes(label = vertex.names),
fontface = "bold",size=1.35) +
xlim(-0.2,1.2)+ylim(-0.2,1.2)+
theme_minimal()+
theme(axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "grey25"),
panel.grid = element_blank())
library(lavaan)
libraru(psych)
library(psych)
head(affect)
head(Harman)
Harman.5
head(Harman.5)
(Harman.5)
Tucker
names(tucker)
names(Tucker)
install.packages("DAKS")
library(DAKS)
pisa
sys.call("wget http://openpsychometrics.org/_rawdata/BIG5.zip")
sys.call("ls")
sys.call(which="ls")
sys.call(which=1L)
system("ls")
system("get http://openpsychometrics.org/_rawdata/BIG5.zip")
system("wget http://openpsychometrics.org/_rawdata/BIG5.zip")
system("unzip BIG5.zip")
bigf_data <- read.csv("BIG5.zip")
bigf_data <- read.csv("BIG5/data.csv")
bigf_data <- read.csv2("BIG5/data.csv")
bigf_data <- read.csv("BIG5/data.csv")
head(bigf_data)
bigf_data <- read.csv("BIG5/data.csv",sep = "\t")
View(bigf_data)
names(bigf_data)
fa(bigf_data[,8:57],nfactors = 5)
fa(bigf_data[,8:57],nfactors = 5) %>% plot
library(sem)
efa_big <- fa(bigf_data[,8:57],nfactors = 5)
structure.sem(efa_big)
efa_big <- fa(bigf_data[,8:57],nfactors = 5)
structure.sem(efa_big)
efa_spec <- structure.sem(efa_big)
efa_spec[1]
efa_spec[150]
efa_spec[104]
efa_spec[104,]
efa_spec[105,]
efa_spec[104,]
?structure.sem
fa.diagram(efa_big)
efa_bigst <- structure.sem(efa_big)
sem(efa_bigst,S = cov(bigf_data[,8:57]),N = 19719)
sem(efa_bigst,S = cov(bigf_data[,8:57]),N = 19719) %>% summary
big_sem <- sem(efa_bigst,S = cov(bigf_data[,8:57]),N = 19719)
summary(big_sem)
summary(big_sem)
structure.diagram(big_sem)
summary(big_sem)
?semTools::lisrel2lavaan()
model <- c('E1 <--- MR1
F1 =~ E1+E2+E3+E4+E5+E6+E7+E8+E9+E10
F2 =~ N1+N2+N3+N4+N5+N6+N7+N8+N9+N10
F3 =~ A1+A2+A3+A4+A5+A6+A7+A8+A9+A10
F4 =~ O1+O2+O3+O4+O5+O6+O7+O8+O9+O10
F5 =~ C1+C2+C3+C4+C5+C6+C7+C8+C9+C10')
big_model <- c('
F1 =~ E1+E2+E3+E4+E5+E6+E7+E8+E9+E10
F2 =~ N1+N2+N3+N4+N5+N6+N7+N8+N9+N10
F3 =~ A1+A2+A3+A4+A5+A6+A7+A8+A9+A10
F4 =~ O1+O2+O3+O4+O5+O6+O7+O8+O9+O10
F5 =~ C1+C2+C3+C4+C5+C6+C7+C8+C9+C10')
lavaan(big_model,data = bigf_data)
big_model <- c('
F1 =~ E1+E2+E3+E4+E5+E6+E7+E8+E9+E10
F2 =~ N1+N2+N3+N4+N5+N6+N7+N8+N9+N10
F3 =~ A1+A2+A3+A4+A5+A6+A7+A8+A9+A10
F4 =~ O1+O2+O3+O4+O5+O6+O7+O8+O9+O10
F5 =~ C1+C2+C3+C4+C5+C6+C7+C8+C9+C10
F1 ~~ F2
F1 ~~ F3
F1 ~~ F4
F1 ~~ F5
F2 ~~ F3
F2 ~~ F4
F2 ~~ F5
F3 ~~ F4
F3 ~~ F5
F4 ~~ F5')
lavaan(big_model,data = bigf_data)
big_model <- c('
F1 =~ E1+E2+E3+E4+E5+E6+E7+E8+E9+E10
F2 =~ N1+N2+N3+N4+N5+N6+N7+N8+N9+N10
F3 =~ A1+A2+A3+A4+A5+A6+A7+A8+A9+A10
F4 =~ O1+O2+O3+O4+O5+O6+O7+O8+O9+O10
F5 =~ C1+C2+C3+C4+C5+C6+C7+C8+C9+C10
F1 ~~ 1*F2
F1 ~~ 1*F3
F1 ~~ 1*F4
F1 ~~ 1*F5
F2 ~~ 1*F3
F2 ~~ 1*F4
F2 ~~ 1*F5
F3 ~~ 1*F4
F3 ~~ 1*F5
F4 ~~ 1*F5')
lavaan(big_model,data = bigf_data)
big_model <- c('
F1 =~ E1+E2+E3+E4+E5+E6+E7+E8+E9+E10
F2 =~ N1+N2+N3+N4+N5+N6+N7+N8+N9+N10
F3 =~ A1+A2+A3+A4+A5+A6+A7+A8+A9+A10
F4 =~ O1+O2+O3+O4+O5+O6+O7+O8+O9+O10
F5 =~ C1+C2+C3+C4+C5+C6+C7+C8+C9+C10
F1 ~~ 1*F1
F2 ~~ 1*F2
F3 ~~ 1*F3
F4 ~~ 1*F4
F5 ~~ 1*F5')
lavaan(big_model,data = bigf_data)
pairs(iris)
iris_model <- c('
F1 =~ Petal.Length + Petal.Width
F2 =~ Sepal.Length + Sepal.Width')
lavaan(big_model,data = bigf_data)
lavaan(iris_model,data = iris)
lavaan(iris_model,data = cov(iris[,1:4]))
iris_model <- c('
F1 =~ Sepal.Width + Petal.Width
F2 =~ Sepal.Length + Petal.Length')
lavaan(iris_model,data = cov(iris[,1:4]))
lavaan(iris_model,data = iris)
iris_model <- c('
F1 =~ Sepal.Width
F2 =~ Sepal.Length')
lavaan(iris_model,data = iris)
lavaan(iris_model,data = iris[1:100,])
iris_model <- c('
F1 =~ Petal.Length + Petal.Width
F2 =~ Sepal.Length + Sepal.Width')
lavaan(iris_model,data = iris[1:100,])
lavaan(iris_model,data = iris[50:150,])
lavaan(iris_model,data = iris[50:150,1:4])
cov[iris[,1:4]]
cov[matrix(iris[,1:4])]
cov(iris[,1:4])
cov(iris[,1:4])
fa(cov(iris[,1:4]))
lavaan(iris_model,data = cov(iris[,1:5])
)
lavaan(iris_model,data = cov(iris[,1:4]))
big_model <- c('
F1 =~ E1+E2+E3
F2 =~ N1+N2+N3
F3 =~ A1+A2+A3')
lavaan(big_model,data = bigf_data)
big_model <- c('
F1 =~ E1+E4+E3
F2 =~ N2+N2+N3
F3 =~ A4+A2+A3')
lavaan(big_model,data = bigf_data)
big_model <- c('
F1 =~ E1+E4+E1
F2 =~ N2+N2+N2
F3 =~ A4+A2+A5')
lavaan(big_model,data = bigf_data)
big_model <- c('
F1 =~ E1+E2+E1
F2 =~ N2+N3+N10
F3 =~ A4+A2+A10')
lavaan(big_model,data = bigf_data)
lavaan(big_model,data = bigf_data[1:100])
lavaan(big_model,data = bigf_data[1:100m])
lavaan(big_model,data = bigf_data[1:100,])
lavaan(big_model,data = bigf_data[1:1000,])
lavaan(big_model,data = bigf_data[1:500,])
big_model <- c('
F1 =~ E1+E2+E4+E5
F2 =~ N2+N3+N10+N4
F3 =~ A4+A2+A10+A1')
lavaan(big_model,data = bigf_data[1:500,])
big_model <- c('
M1 =~ E1+E2+E4+E5
M2 =~ N2+N3+N10+N4
M3 =~ A4+A2+A10+A1')
lavaan(big_model,data = bigf_data[1:500,])
big_model <- c('
M1 =~ E1+E2+E4+E5+E7
M2 =~ N2+N3+N10+N4+N8
M3 =~ A4+A2+A10+A1+A2')
lavaan(big_model,data = bigf_data[1:500,])
big_sem
big_sem$ram
big_sem$S
big_sem$semmod
big_sem$J
big_sem$robust.vcov
big_sem %>% plot
plot(big_sem)
sem.diagram(big_sem)
sem.diagram(big_sem,main = "Big Five")
?sem.diagram(big_sem,main = "Big Five")
?sem.diagram(big_sem,main = "Big Five",e.size=1)
sem.diagram(big_sem,main = "Big Five",e.size=1)
sem.diagram(big_sem,main = "Big Five",e.size=0.5)
sem.diagram(big_sem,main = "Big Five",e.size=0.1)
sem.diagram(big_sem,main = "Big Five",e.size=0.01)
sem.diagram(big_sem,main = "Big Five",e.size=0.05)
