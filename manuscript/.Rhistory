geom_text(label="P(A|X) \n mu ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n mu ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior of difference \n mu ~ 0.49",color="white",x=0.3,y=0.3)+
theme_hc(style = "darkunica")
.rs.restartR()
set.seed(2600)
n_obs <- 400
a <- rnorm(n=n_obs, sd =1, mean=0)
b <- rnorm(n=n_obs, sd=1, mean=0.6)
likel <- function(n,x,mu,sigma){
l_val <- (-n/2)*log(2*pi*sigma^2) - (1/2*sigma^2)*sum((x - mu)^2)
return(-l_val) # multiplica(-1)
}
log_norm <- function(n,mu,sigma){
require(magrittr) # para o operador %>%
# Truque para obter distribuicao ~ uniforme em [-Inf,+Inf]
unif_dist <- 1/runif(n = n, min = -1,max = 1)
l_val <- dnorm(x=unif_dist,mean = 0,sd = 1, log=T)
l_val <- car::recode(l_val,"-Inf:-1000=-1000") %>% sum # recod. valores extremos
return(-l_val)
}
mc_chain <- function(obs,iter=4000,n_obs=length(obs)){
# seeds e objetos
sample <- matrix(nrow = iter, ncol = 2)
s1_mu <- rnorm(n=1,mean=0) # media inicial
s_sigma <- 1 # variancia = 1
s1_lik <- 2000
for (i in 1:iter){
# Salva estado
s0_mu <- s1_mu
s0_lik <- s1_lik
# Realiza um passo (random walk)
s1_mu <- s1_mu + rnorm(n=1,mean = 0, sd=0.5)
s1_lik <- likel(n=n_obs,x=obs,mu=s1_mu,sigma=s_sigma) +
# log do prior é normalizado por 1000
log_norm(n=10000,mu=0,sigma=1)/1000
# Rejeita diferenças maiores que 5, assumindo o valor no estado anterior
if(s1_lik - s0_lik > 5)
s1_mu <- s0_mu
sample[i,] <- c(s1_mu,s_sigma) # Salva
}
return(sample[1001:iter,1]) # Descarta as primeiras 1000 amostras (warm-up)
}
posterior_a <- mc_chain(obs = a,iter = 4000)
posterior_b <- mc_chain(obs = b,iter = 4000)
posteriors_data <- data.frame(post_a=posterior_a, post_b=posterior_b)
library(ggplot2)
library(ggthemes)
posts_plot <- ggplot(data = posteriors_data, aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Density") +
geom_text(label="P(A|X) \n mu ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n mu ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior of difference \n mu ~ 0.49",color="white",x=0.3,y=0.3)+
theme_hc(style = "darkunica")
ggplot(data=posteriors_data,aes(y=posterior_a))
ggplot(data=posteriors_data,aes(y=posterior_a))+geom_line
ggplot(data=posteriors_data,aes(y=posterior_a))+geom_line(
)
ggplot(data=posteriors_data,aes(y=posterior_a,x=1:nrow(posteriors_data)))+geom_line()
ggplot(data=posteriors_data,
aes(y=posterior_a,x=1:nrow(posteriors_data)))+
geom_line()+xlab("A Chain")+ylab("")+
theme_hc("style="darkunica")
ggplot(data=posteriors_data,
aes(y=posterior_a,x=1:nrow(posteriors_data)))+
geom_line()+xlab("A Chain")+ylab("")+
theme_hc(style="darkunica")
ggplot(data=posteriors_data,
aes(y=posterior_a,x=1:nrow(posteriors_data)))+
geom_line()+xlab("A Chain")+ylab("")+
theme_hc(style = "darkunica")
ggplot(data = posteriors_data, aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Density") +
geom_text(label="P(A|X) \n mu ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n mu ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior of difference \n mu ~ 0.49",color="white",x=0.3,y=0.3)+
theme_hc(style = "darkunica")
unloadNamespace("cowplot")
ggplot(data = posteriors_data, aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Density") +
geom_text(label="P(A|X) \n mu ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n mu ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior of difference \n mu ~ 0.49",color="white",x=0.3,y=0.3)+
theme_hc(style = "darkunica")
library(ggthemes)
ggplot(data = posteriors_data, aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Density") +
geom_text(label="P(A|X) \n mu ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n mu ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior of difference \n mu ~ 0.49",color="white",x=0.3,y=0.3)+
theme_hc(style = "darkunica")
library(ggthemes)
detach("package:cowplot", unload=TRUE)
detach("cowplot", unload=TRUE)
detach("package::cowplot", unload=TRUE)
detach(package:cowplot)
?detach()
detach(name = package:cowplot)
detach(name = package:ggplot2)
ggplot(data = posteriors_data, aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Density") +
geom_text(label="P(A|X) \n mu ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n mu ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior of difference \n mu ~ 0.49",color="white",x=0.3,y=0.3)+
theme_hc(style = "darkunica")
library(ggplot2)
ggplot(data = posteriors_data, aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Density") +
geom_text(label="P(A|X) \n mu ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n mu ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior of difference \n mu ~ 0.49",color="white",x=0.3,y=0.3)+
theme_hc(style = "darkunica")
library(ggthemes)
ggplot(data = posteriors_data, aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Density") +
geom_text(label="P(A|X) \n mu ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n mu ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior of difference \n mu ~ 0.49",color="white",x=0.3,y=0.3)+
theme_hc(style = "darkunica")
.rs.restartR()
library(ggplot2)
library(ggthemes)
ggplot(data = posteriors_data, aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Density") +
geom_text(label="P(A|X) \n mu ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n mu ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior of difference \n mu ~ 0.49",color="white",x=0.3,y=0.3)+
theme_hc(style = "darkunica")
ggplot(data=posteriors_data,
aes(y=posterior_a,x=1:nrow(posteriors_data)))+
geom_line()+xlab("A Chain")+ylab("")+
theme_hc(style="darkunica")
ggplot(data=posteriors_data,
aes(y=posterior_a,x=1:nrow(posteriors_data)))+
geom_line(color="light green")+xlab("A Chain")+ylab("")+
geom_line(color="dark green")+xlab("B Chain")+ylab("")+
theme_hc(style="darkunica")
ggplot(data=posteriors_data,
aes(y=posterior_a,x=1:nrow(posteriors_data)))+
geom_line(color="light green")+xlab("A Chain")+ylab("")+
geom_line(color="purple")+xlab("B Chain")+ylab("")+
theme_hc(style="darkunica")
ggplot(data=posteriors_data,
aes(y=posterior_a,x=1:nrow(posteriors_data)))+
geom_line(color="light green")+xlab("A Chain")+ylab("")+
geom_line(aes(y=posterior_b,x=1:nrow(posteriors_data)),
color="dark green")+xlab("B Chain")+ylab("")+
theme_hc(style="darkunica")
posts_plot
posts_plot <- ggplot(data = posteriors_data, aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Density") +
geom_text(label="P(A|X) \n mu ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n mu ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior of difference \n mu ~ 0.49",color="white",x=0.3,y=0.3)+
theme_hc(style = "darkunica")
traces_plot <- ggplot(data=posteriors_data,
aes(y=posterior_a,x=1:nrow(posteriors_data)))+
geom_line(color="light green")+xlab("Chains")+ylab("")+
geom_line(aes(y=posterior_b,x=1:nrow(posteriors_data)),
color="dark green")+xlab("B Chain")+ylab("")+
theme_hc(style="darkunica")
source('~/dev-playground/stat-learn/manuscript/aux/multiplot.R')
multiplot(posts_plot,traces_plot,cols = 1)
traces_plot <- ggplot(data=posteriors_data,
aes(y=posterior_a,x=1:nrow(posteriors_data)))+
geom_line(color="light green")+xlab("Chains")+ylab("")+
geom_line(aes(y=posterior_b,x=1:nrow(posteriors_data)),
color="dark green")+
theme_hc(style="darkunica")
multiplot(posts_plot,traces_plot,cols = 1)
ggsave("images/chap5-posterior_diff_mcmc.png",type="cairo-png",units="cm",width = 15,height = 15,dpi=300)
posts_plot <- ggplot(data = posteriors_data, aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Densidade") +
geom_text(label="P(A|X) \n mu ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n mu ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior da diferença \n mu ~ 0.49",color="white",x=0.3,y=0.3)+
theme_hc(style = "darkunica")
ggplot(data = posteriors_data, aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Densidade") +
geom_text(label="P(A|X) \n mu ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n mu ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior da diferença \n mu ~ 0.49",color="white",x=0.3,y=0.3)+
theme_hc(style = "darkunica")
posts_plot <- ggplot(data = posteriors_data, aes(x=posterior_a)) +
geom_histogram(aes(y=..density..),color = "light green", alpha=0.1) +
geom_histogram(aes(x=posterior_b, y=..density..), alpha=0.1, color="dark green") +
geom_density(aes(x=(posterior_b - posterior_a)), color="green") +
xlab("Posteriors") + ylab("Densidade") +
geom_text(label="P(A|X) \n mu ~ 0.08",color="white",x=-0.2,y=1)+
geom_text(label="P(B|X) \n mu ~ 0.57",color="white",x=1,y=1)+
geom_text(label="Posterior da diferença \n mu ~ 0.49",color="white",x=0.3,y=0.3)+
theme_hc(style = "darkunica")
traces_plot <- ggplot(data=posteriors_data,
aes(y=posterior_a,x=1:nrow(posteriors_data)))+
geom_line(color="light green")+xlab("Chains")+ylab("")+
geom_line(aes(y=posterior_b,x=1:nrow(posteriors_data)),
color="dark green")+
theme_hc(style="darkunica")
multiplot(posts_plot,traces_plot,cols = 1)
sd(posterior_a)
sd(posterior_b)
sd(posterior_b - posterior_a)
mean(a)
meanb(b)
mean(b)
0.5*0.5
0.5*0.5
n_moment <- function(x,n) {(x- mean(x))^n}
n_moment(rnorm(10))
n_moment(rnorm(10),1)
n_moment <- function(x,n) {sum((x- mean(x))^n)}
n_moment(rnorm(10),1)
n_moment(rnorm(0),1)
n_moment(rnorm(100),1)
n_moment(rnorm(10),1)
n_moment(rnorm(5),1)
n_moment(rnorm(10),1)
n_moment(rnorm(mean = 2,10),1)
n_moment(rnorm(mean = 3,10),1)
n_moment(rnorm(10),1)
n_moment(rnorm(10),2)
n_moment(rnorm(10),2)
n_moment(rnorm(10),2)
n_moment(rnorm(10),2)
n_moment(rnorm(10),2)
n_moment(rnorm(100),2)
n_moment(rnorm(1000),2)
n_moment(rnorm(10000),2)
n_moment <- function(x,n) {sum((x- mean(x))^n)/length(x)}
n_moment(rnorm(1000),2)
n_moment(rnorm(1000),2)
n_moment(rnorm(1000),2)
n_moment(rnorm(1000),2)
n_moment(rnorm(1000),1)
n_moment(rnorm(1000),1)
n_moment(rnorm(1000),3)
n_moment(rnorm(1000),3)/n_moment(rnorm(1000),2)^(3/2)
e1071::skewness(rnorm(1000))
princomp(iris[,4])
princomp(iris[,1:4],)
princomp(iris[,1:4]) %>% summary
a <- princomp(iris[,1:4],)
a$loadings
a$scores
a$loadings %>% class
library(magrittr)
a$loadings %>% class
a$loadings %>% type
a$loadings %>% typeof
a$loadings %>% class
a$loadings[1] %>% class
library(rstan)
library(BEST)
?BEST::BESTmcmc()
1e+05
1e+05 + 1
<- BEST::BESTmcmc(y1 = iris$Sepal.Length,y2 = iris$Sepal.Width,
numSavedSteps = 3000)
a <- BEST::BESTmcmc(y1 = iris$Sepal.Length,y2 = iris$Sepal.Width,
numSavedSteps = 3000)
a$mu1
a$nu
a
14*14
set.seed(2600)
my.image.data <- sample(0:1,100,replace=T)
my.image.data
my.image.data <- c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,)
my.image.data <- c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0)
length(my.image.data)
set.seed(2600)
my.image.data <- c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,.9,.6,0,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,.7,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,0,.9,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0)
x <- matrix(my.image.data,14,14)
x
plot(x)
plot(x)
plot(my.image.data,x=1:14,y=1:14)
heat.map(my.image.data)
heatmap(my.image.data)
class(my.image.data)
heatmap(x)
heatmap(x,Rowv = 1:14)
heatmap(x,Rowv = 14)
require(fields)
install.packages("fields")
par(mar=c(0, 0, 0, 0))
image(x, useRaster=TRUE, axes=FALSE)
image(x, axes = FALSE, col = grey(seq(0, 1, length = 256)))
image(x, axes = FALSE, col = grey(seq(1, 0, length = 256)))
View(x)
x <- matrix(my.image.data,14,14,byrow=T)
image(x, axes = FALSE, col = grey(seq(1, 0, length = 256)))
View(x)
image(x,  col = grey(seq(1, 0, length = 256)))
?image()
x^t
image(t(x), axes = FALSE, col = grey(seq(1, 0, length = 256)))
my.image.data <- c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,.9,.6,0,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,.7,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,0,.9,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0) %>% matrix(.,14,14,byrow=T)
library(magrittr)
my.image.data <- c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,.9,.6,0,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,.7,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,0,.9,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0) %>% matrix(.,14,14,byrow=T)
my.image.data <- c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,.9,.6,0,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,.7,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,0,.9,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0) %>%
matrix(.,14,14,byrow=T)
View(my.image.data)
plot_data <- apply(t(my.image.data),2,rev)
image(plot_data, axes = FALSE, col = grey(seq(1, 0, length = 256)))
plot_data <- apply(t(my.image.data),2,rev)
image(plot_data, axes = FALSE, col = grey(seq(1, 0, length = 256)))
plot_data <- t(my.image.data)
image(plot_data, axes = FALSE, col = grey(seq(1, 0, length = 256)))
plot_data <- apply(t(my.image.data),1,rev)
image(plot_data, axes = FALSE, col = grey(seq(1, 0, length = 256)))
image(t(my.image.data), axes = FALSE, col = grey(seq(1, 0, length = 256)))
rev(my.image.data)
?rev(my.image.data)
apply(my.image.data,2,rev)
image(apply(t(my.image.data),2,rev), axes = FALSE, col = grey(seq(1, 0, length = 256)))
image(apply(t(my.image.data),1,rev), axes = FALSE, col = grey(seq(1, 0, length = 256)))
image(apply(t(my.image.data),2,rev), axes = FALSE, col = grey(seq(1, 0, length = 256)))
image(apply(t(my.image.data),2,*1), axes = FALSE, col = grey(seq(1, 0, length = 256)))
image(apply(t(my.image.data),2,function(x) x*1), axes = FALSE, col = grey(seq(1, 0, length = 256)))
image(my.image.data[14:1,], axes = FALSE, col = grey(seq(1, 0, length = 256)))
image(t(my.image.data[14:1,]), axes = FALSE, col = grey(seq(1, 0, length = 256)))
set.seed(2600)
my.image.data <- c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,1,.9,.6,1,0,0,0,0,0,0,
0,0,0,0,1,0,1,1,0,0,0,0,0,0,
0,0,0,0,0.9,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,.7,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,1,0,0,0,0,0,0,
0,0,0,0,0,0,1,.9,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0) %>%
matrix(.,14,14,byrow=T)
image(t(my.image.data[14:1,]), axes = FALSE, col = grey(seq(1, 0, length = 256)))
dir("images/")
phi_heavi <- function(x){ifelse(x >=0,1,-1)}
my_weights <- rnorm(196)/100
w <- matrix(my_weights,196,1)
x
as.vector(x) %*% w
my_weights <- rnorm(196)
w <- matrix(my_weights,196,1)
as.vector(x) %*% w
as.vector(x) %*% w %>% phi_heavi
x
as.vector(my.image.data) %*% w
as.vector(x) %*% w %>% phi_heavi
View(iris)
glm(Petal.Length ~ Sepal.Length + Sepal.Width,iris)
glm(Petal.Length ~ Sepal.Length + Sepal.Width,iris[1:100,])
glm(Petal.Length ~ Sepal.Length + Sepal.Width,iris[1:100,],family = "linear")
glm(Petal.Length ~ Sepal.Length + Sepal.Width,iris[1:100,],family = "gaussia")
glm(Petal.Length ~ Sepal.Length + Sepal.Width,iris[1:100,],family = "gaussian")
glm(Petal.Length ~ Sepal.Length + Sepal.Width,iris[1:100,],family = "gaussian") %>% summary
glm(Petal.Length ~ Sepal.Length + Sepal.Width,iris[1:100,],family = "gaussian") %>% summary
library(deepnet)
train_df <- iris[1:100, c(1, 2, 5)]
train_df[, 4] <- -1
train_df[train_df[, 3] == "setosa", 4] <- 1
names(train_df) <- c("s.len", "s.wid", "species","target")
y_target <- train_df[, 4]
train_df <- iris[, c(1, 2, 3)]
names(train_df) <- c("s.len", "s.wid", "p.len")
x_features <- train_df[, c(1, 2)]
y_target <- train_df[, 3]
dbn.dnn.train(y=y_target,x=x_features,hidden = 2,output = "linear")
dbn.dnn.train(y=y_target,x=matrix(x_features),hidden = 2,output = "linear")
matrix(x_features)
dbn.dnn.train(y=y_target,x=as.matrix(x_features),hidden = 2,output = "linear")
a <- dbn.dnn.train(y=y_target,x=as.matrix(x_features),hidden = 2,output = "linear")
deepnet::nn.predict(a)
deepnet::nn.predict(a,y_target)
deepnet::nn.predict(a,x = y_target)
deepnet::nn.predict(a,x = as.nuemric(y_target))
deepnet::nn.predict(a,x = as.numeric(y_target))
a
a <- dbn.dnn.train(y=y_target,x=as.matrix(x_features),hidden = 2,output = "linear")
deepnet::nn.test()
deepnet::nn.predict(a)
deepnet::nn.predict(a,x=x_features)
preds <- deepnet::nn.predict(a,x=x_features)
cor.test(preds,y_target)
preds <- deepnet::nn.predict(a,x=as.matrix(x_features))
preds
x_features
a <- dbn.dnn.train(y=y_target,x=as.matrix(x_features),output = "linear")
preds <- deepnet::nn.predict(a,x=as.matrix(x_features))
preds
preds <- deepnet::nn.predict(a)
a
a <- dbn.dnn.train(y=y_target,x=as.matrix(x_features))
y_target
as.matrix(x_features)
library(caret)
train(x=x_features,y = y_target,method = "brnn")
train(x=x_features,y = y_target,method = "mlpWeightDecay")
